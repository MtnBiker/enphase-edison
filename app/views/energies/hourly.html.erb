<!-- app/views/hourly.html.erb -->
<p style="color: green"><%= notice %></p>

<!-- <h1>Hourly Energy Generation and Use</h1>
<p class="fst-italic">* Enphase and Edison don't always agree. Some times when Enphase reports no production, Edison reports both sending and receiving energy. This can result in a negative being reported for usage which isn't possible without a battery. Something to be resolved.</p> -->
<p><%#= link_to "Energy Day by Day", daily_url %> <%#= link_to "Energy Month by Month", monthly_url %></p> 
<!-- This may be just so something is displayed when this page is first displayed-->
<%# theDate = Date.today.last_month.beginning_of_month %>

<!-- Stimulus part 1
<div data-controller="hourly-graph">
  <%#= render "hourly_graph", theDate: theDate  %>
</div> -->

<!-- <h5>Pick a new date to display</h4> -->

<!-- Turbo -->
<%= form_tag process_date_path, method: :post, remote: true do %>
  <%= label_tag :the_date, 'Select a New Date to Display' %>
  <%= date_field_tag :the_date, @the_date ||= Date.current - 30.days %>
  <!-- <input type="date" name="the_date" id="the_date"> With no default-->
  <%= submit_tag 'Update graph for selected date' %>
<% end %>

<%= render 'energies/hourly_graph' %>
<!-- End turbo but may need to move this last line up -->

<!-- <%##= form_tag process_date_path, method: :post, data: { controller: "hourly-graph" } do %>
  <%##= label_tag :the_date, 'Pick a Date' %>
  <%##= date_field_tag :the_date, @selected_date, data: { target: "hourly-graph.dateInput" } %>
  <%##= submit_tag 'Update graph for selected date', data: { action: "hourly-graph#updateGraph" } %>
<%## end %> -->

<!-- This was for a false start with Stimulus part 2
<%#= form_tag process_date_path, method: :post, data: { controller: "hourly-graph" } do %>
  <%#= label_tag :the_date, 'Pick a Date' %>
  <%#= date_field_tag :the_date, @selected_date, data: { target: "hourly-graph.dateInput" } %>
  <%#= submit_tag 'Update graph for selected date', data: { action: "click->hourly-graph#updateGraph" } %>
<%# end %> -->

<hr class="border-bottom border-3 border-dark">

<table class="index-table">
  <!-- Table head is common to hourly, daily, monthly -->
  <%= render 'table_head' %>
  <tbody>    
    <!-- view_day_by_day defined in energies_controller with reference to model day_by_day.rb-->
    <!-- Change this to only do table for the_date , the_date: the_date TODO -->
    <% @hour_by_hours.each do |energy| %>
      <%= render partial: 'hourly', locals: { energy: energy } %>
    <% end %>
  </tbody>
</table>

<div class="pag-bar mt-5 pt-5">
  <%#== pagy_bootstrap_nav(@pagy) %>
</div>

<!-- Graphs/Charts -->
<%= render "graph_demos" %>

<%= render 'import_buttons' %>
