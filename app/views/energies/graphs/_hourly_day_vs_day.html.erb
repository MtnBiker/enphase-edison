<!-- app/views/energies/_hourly_graph.erb.html -->
<div id="graph">
  <hr class="border-bottom border-3 border-dark">

    <!-- Display the graph using the @the_date variable if it's defined -->
    <% if defined? the_date %>
      <!-- <p>Selected Date: <%= the_date %></p> -->
    <% else %>
      <!-- <p>No date selected yet</p> -->
      <% the_date = Date.current - 1.month %>
    <% end %>
    
    <!-- First trial Need to feed in the date-->
    <% other_date = the_date - 3.days %>

  <div class="text-center font-weight-bold">
     <h4>Production Hour by Hour for One day: <%= other_date.strftime("%d %b %Y") %> and Another day <%= the_date.strftime("%d %b %Y") %></h4>
  
  <!-- For some reason just picking a date, it is 8 hours short, probably a time zone issue, but adding 0 hours fixes it UGLY and did it for other_date to be sure -->
   <%= the_date = the_date + 0.hour %>
   <%= other_date = other_date + 0.hour %>
   
   <!-- debug to see confirm dates within a dy -->
   <%#= the_date = the_date + 2.hour %>
   <%#= other_date = other_date + 2.hour %>
   
   <!-- 23 gets from 00:00 to 23:00 but is that missing the 3 15 minute periods -->
   <% the_date_time_span = the_date..the_date + 23.hour %>
   <% other_date_time_span = other_date..other_date + 23.hour %>
   <!-- <p>the_date_time_span.class: <%= the_date_time_span.class %></p> -->
   
   
  <p>day_one_array: <%= day_one_array = HourByHour.where(datetime: other_date_time_span).pluck(:datetime, :enphase) %></p>
  <p>day_two_array: <%=  day_two_array = HourByHour.where(datetime: the_date_time_span).pluck(:datetime, :enphase) %></p>
    <!-- Could pass in a variable for number of days or do that in hourly -->
    
    <%= line_chart [
      {name: "One day", data: HourByHour.where(datetime: other_date_time_span).pluck(:datetime, :enphase)},
      {name: "Another day", data: HourByHour.where(datetime: the_date_time_span).pluck(:datetime, :enphase)}      
      ]
    %>
    <p>Testing that can get array into line_chart and it works</p>
    <%= line_chart [
      {name: "Day One", data: day_one_array},
      {name: "Day Two", data: day_two_array}      
      ]
    %>
    <!-- HourByHOur[0]
  <#%= (HourByHour.where(datetime: other_date_time_span).pluck(:datetime, :enphase))[0] %> -->
  
    <%# the_date_data =  %>
    
    <%# other_date_data = %>
    <%#= the_date_data.to_a %>
    <!-- other_date_data.class : <%#= other_date_data.class %> -->
    <%#= other_date_data.to_a %>
  <!-- <p>  other_date_data.to_a.class : <%#= other_date_data.class %></p> -->
  
  <!-- <%#= line_chart [
      {name: "One day", data: the_date_data},
      {name: "Another day", data: other_date_data}      
      ]
    %> -->
  </div>
  
  <hr class="border-bottom border-3 border-dark">
</div>
